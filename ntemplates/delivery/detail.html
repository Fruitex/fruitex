{% extends "delivery/base.html" %}
{% load static %}
{% load tz %}

{% localtime on %}

{% block content %}

<h1>Delivery Window</h1>
<h2>{{ delivery_window.store }}: {{ delivery_window }}</h2>
<ul>
  {% for order in delivery_window.orders.all %}
  <li>
    <div>
      <a href="{% url 'order:show' order.invoice.invoice_num %}">
        Order {{ order }}: {{ order.get_status_display }} ({{ order.items.count }} items)
      </a>
    </div>
    <div>
      <table id='order-confirm-table'>
      <tbody>
        <tr>
          <td>
            Invoice status:
          </td>
          <td>
            {{ order.invoice.get_status_display }}
          </td>
        </tr>
        <tr>
          <td>
            Name:
          </td>
          <td>
            {{ order.invoice.customer_name }}
          </td>
        </tr>
        <tr>
          <td>
            Address:
          </td>
          <td>
            {{ order.invoice.address }}
          </td>
        </tr>
        <tr>
          <td>
            ZIP:
          </td>
          <td>
            {{ order.invoice.postcode }}
          </td>
        </tr>
        <tr>
          <td>
            Phone:
          </td>
          <td>
            {{ order.invoice.phone }}
          </td>
        </tr>
        <tr>
          <td>
            Email:
          </td>
          <td>
            {{ order.invoice.email }}
          </td>
        </tr>
      </tbody>
      </table>
    </div>
    <ul class="delivery-item-list">
      {% for order_item in order.order_items %}
      <li class="item">
        <img src="{% static 'store_imgs/' %}{{ order_item.item.sku }}.JPG">
        <span>{{ order_item.quantity }} x</span>
        <span>
          <span>{{ order_item.item.name }}</span>
          <label><input type="checkbox" {% if order_item.allow_sub %}checked{% endif %} disabled>Sub</label>
        </span>
      </li>
      {% endfor %}
    </ul>
  </li>
  {% endfor %}
</ul>

<h1>Shopping List (Excluding pending orders)</h1>
<ol class="shopping-item-list">
  {% for item, quantity in combined_items.items %}
  <li class="item">
    <img src="{% static 'store_imgs/' %}{{ item.sku }}.JPG">
    <span>{{ quantity }} x </span>
    <span>{{ item.name }}</span>
    {% if item.on_sale %}
    <span> Sales Price: {{ item.sales_price }}</span>
    {% else %}
    <span> Price: {{ item.price }}</span>
    {% endif %}
    {% if item.category.shop_location_note %}
    <br>
    <span> Location: {{ item.category.shop_location_note }}</span>
    {% endif %}
  </li>
  {% endfor %}
</ol>

<a href="{% url 'delivery:summary' %}">Go back to summary</a>

{% endblock %}

{% endlocaltime %}
